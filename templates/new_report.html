<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRa9yAaau5PhnGM0szW4OI5D7_QsPmjbk&libraries=places"></script>
</head>
<body>

    <!-- Add your navbar here -->
    {% include 'navbar.html' %}

    <div class="container mt-5">
        <h2>Submit a New Report</h2>

        <form action="/create_report" method="POST">
            <!-- Report Title -->
            <div class="mb-3">
                <label for="report-title" class="form-label">Report Title</label>
                <input type="text" class="form-control" id="report-title" name="report-title" required>
            </div>

            <!-- Description -->
            <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <textarea class="form-control" id="description" name="description" required></textarea>
            </div>

            <!-- Category -->
            <div class="mb-3">
                <label for="category" class="form-label">Category</label>
                <select class="form-control" id="category" name="category" required>
                    <option value="">-- Select Category --</option>
                    <option value="incident">Incident</option>
                    <option value="crime">Crime</option>
                    <option value="accident">Accident</option>
                    <option value="fire">Fire</option>
                </select>
            </div>

            <!-- Address -->
            <div class="mb-3">
                <label for="address" class="form-label">Address</label>
                <input type="text" class="form-control" id="address" name="address" placeholder="Enter address" required>
            </div>

            <!-- Longitude -->
            <div class="mb-3">
                <label for="longitude" class="form-label">Longitude</label>
                <input type="text" class="form-control" id="longitude" name="longitude" readonly>
            </div>

            <!-- Latitude -->
            <div class="mb-3">
                <label for="latitude" class="form-label">Latitude</label>
                <input type="text" class="form-control" id="latitude" name="latitude" readonly>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary">Submit Report</button>
        </form>
    </div>

    <!-- Google Maps Geocoding Script -->
    <script>
        // Initialize the Google Maps Geocoder
        function initGeocoder() {
            const geocoder = new google.maps.Geocoder();
            const addressInput = document.getElementById('address');

            // Listen for the blur event on the address input field
            addressInput.addEventListener('blur', function() {
                const address = addressInput.value;

                if (address) {
                    geocoder.geocode({'address': address}, function(results, status) {
                        if (status === 'OK') {
                            const location = results[0].geometry.location;
                            const lat = location.lat();
                            const lng = location.lng();

                            // Populate the longitude and latitude fields
                            document.getElementById('latitude').value = lat;
                            document.getElementById('longitude').value = lng;
                        } else {
                            alert("Geocode was not successful for the following reason: " + status);
                        }
                    });
                }
            });
        }

        // Load the geocoder when the page is ready
        window.onload = initGeocoder;
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
